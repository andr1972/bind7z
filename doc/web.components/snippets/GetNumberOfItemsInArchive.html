<span class="java-keyword">private</span> <span class="java-keyword">int</span> getNumberOfItemsInArchive(String archiveFile) <span class="java-keyword">throws</span> Exception {
    ISevenZipInArchive archive;
    RandomAccessFile randomAccessFile;

    randomAccessFile = <span class="java-keyword">new</span> RandomAccessFile(archiveFile, <span class="java-string">"r"</span>);

    archive = SevenZip.<span class="java-staticmethod">openInArchive</span>(ArchiveFormat.<span class="java-staticfield">ZIP</span>, <span class="java-comment">// null - autodetect</span>
            <span class="java-keyword">new</span> RandomAccessFileInStream(
                    randomAccessFile));

    <span class="java-keyword">int</span> numberOfItems = archive.getNumberOfItems();

    archive.close();
    randomAccessFile.close();

    <span class="java-keyword">return</span> numberOfItems;
}
